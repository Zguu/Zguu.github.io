---
title: " [베이지안 추론] Bernoulli Likelihood with hierarchical Prior"
tags: Study Bayesian Algorithm Metropolis Probability
---

# Chapter 9. Bernoulli Likelihood with hierarchical Prior
$\ $이전 챕터에서는, 파라미터들이 서로 독립적이라는 가정하에 샘플링을 진행했지만, 이번 챕터에서는 두개 또는 그 이상의 파라미터들이 서로 독립적 관계일 때를 살펴본다. 예를 들어, 우리는 동전기 주조되는 공장에 따라 동전의 bias가 달라진다고 가정해보자. 우리는 주조에서 파라미터 값에 대한 사전 믿음을 갖고 있고, 주조를 진행하는 파라미터들에도 동전의 bias가 의존한다는 사전 믿음을 갖고있다. 그리고 우리는 동전을 몇번 던진 후에 얼마나 heads가 나오는 지를 관측한다. 데이터들은 우리의 동전의 bias에 대한 믿음에 영향을 끼친다. 이뿐만 아니라, 동전의 bias가 주조 파라미터에 의존할 것이라는 믿음 자체에 대해서도 영향을 끼친다. 또한 주조 파라미터 값들 자체에 대한 우리의 믿음도 영향을 끼친다.
>말이 좀 복잡해지는데.. 다른 예를 들어보자. 우리는 로또를 맞을 확률이 매주 서로 독립이라는 것을 이미 알고 있다. 그런데 어느날부터 로또 당첨 방송이 사실 조작이라는 의심을 품게된다. 즉, 지금까지의 로또 1등 당첨결과가 이번주에도 영향을 끼칠 것이라고 믿지 시작한 것이다 (실제로 그럴 일은 없다). 의심을 품기 시작한 시점에 나는 이 방송이 조작일 것이라고 10%정도로 의심했다. 하지만 매주 데이터들을 보면서 나의 이 의심 자체에도 의구심이 들어서 의심의 정도가 5%로 내려갔다. 그런데, 내가 이 로또 방송을 의심하게 만든 다른 변수(뭐...예를 들어 주변에서 2번 연속 당첨받은 사람?) 값 자체에도 의심이 생기기 시작했다. 예시가 적절한지 모르겠다. (난 잘한 것 같은데)

데이터들 자체에도 직접적으로 영향을 끼치는 파라미터들은 그냥 여전히 파라미터(parameter)라고 부르자. 다만, 우리의 믿음에 영향을 줌으로써 데이터에 영향을 끼치는 파라미터들은 하이퍼 파라미터(hyper parameter)라고 부르자. 사실 어떤 관점에서 보면 일반 파라미터와 하이퍼 파라미터간에는 차이가 없다. <br>
## 9.1 A single coin from a single mint
$\ $동전의 평향도 $\theta$는 head를 얻을 확률을 결정하며 그에 대한 베르누이 분포는 우리가 알듯이 아래와 같다.
!['Img'](https://imgur.com/Q2S7upQ.png)
bias에 대한 사전 분포는 $p(\theta)$로 표현 되는데, 현재 예시에서, 이 사전분포가 베타분포라고 가정했다. 베타분포는 a,b 두개의 파라미터를 가지며 다음과 같이 정의됨을 안다: beta$$(\theta,a,b) = \theta^{(a-1)} (1-\theta)^{(b-1)}/B(a,b)$$ 이 베타 분포를 조금 더 직관적으로 만들기 위해, 상응하는 평균 $\mu$, 샘플 수 $K$를 이용해서 표현해보자. $$a = \mu K$$, $$b = (1-\mu)K$$임을 이미 배웠다. 따라서 다음과 같이 표현이 가능하다.
!['Img2'](https://imgur.com/05EFpje.png)
---
!['Img3'](https://imgur.com/tQzFcSK.png)
