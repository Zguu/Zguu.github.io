---
title: " [추천시스템] Session Based Recommender System"
tags: Recommender Session
---

기존의 Collaborative Filtering 또는 유저의 활동 내역 기반 추천 시스템은 콜드 스타트에서 자유로울 수 없다. 이러한 약점은 컨텐츠 기반 추천에서는 극복할 수 있다. 다만 이는 유저의 행동 데이터를 고려하기 힘들다. 세션 기반 추천은 비회원 또는 로그인을 하지 않아 과거 데이터가 배치에 축적되지 않은 유저에게 유용하게 사용될 수 있다. 이는 일정 시간동안 유저가 서비스에 남긴 클릭과 같은 행동 정보를 세션이라는 하나의 구간으로 묶어, 해당 세션에서 일어난 행동 데이터를 분석하여 추천으로 이끌어내는 것을 의미한다.

가장 간단한 세션 추천으로는, 해당 세션에서 마지막에 클릭한 상품의 유사 상품을 찾아내는 방법이다. TF-IDF 를 통해 상품 정보에서 키워드 정보를 정리하고 자카드 유사도 측정법을 통해 유사 상품을 찾아낼 수 있다. 하지만 이 또한, 마지막에 클릭한 상품 또는 세션 전체에서 클릭한 상품들에 적절한 유사도 weight를 줘야 하는데, 이 부분에 있어서 적절한 threshold 포인트를 찾기 힘들다.

다른 방법으로는 순환신경망 RNN을 활용하기도 한다. 하지만 이는 내부 유닛이 많아지면 Gradient Descent 법으로 학습이 힘들어질 수도 있고, 경사 값이 사라지는 vanishing gradient 문제가 발생한다.

이와 같은 약점을 보완하는 LSTM, GRU와 같은 방법론들이 있는데, 여기서는 GRU를 활용한다.

BPR (Bayesian Personalized Ranking)
BPR의 손실함수는 다음과 같다.<br>
<center>$$ L_{bpr} = - \frac{1}{N_S}\dot\sum_{j=1}^{N_S} \log(\sigma(r_i - r_j)) $$</center>

이 식은 
