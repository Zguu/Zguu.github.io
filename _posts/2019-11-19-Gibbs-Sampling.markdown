---
title: " [베이지안 추론] Gibbs Sampling(1)"
tags: Study Bayesian Algorithm Metropolis Probability Gibbs Sampling
---
# Inferring Two Binomial proportions via Gibbs sampling
$\ $이번 챕터는 두 개의 독립적인 이항 비율들에 대한 추론을 어떻게 하는 지에 대해 다룬다. 예를 들어, 우리가 두개의 동전을 갖고 있고 얼마나 그들의 편향도(biases)들이 다른지에 대해 결정하길 원한다고 가정해보자. 이 문제는 각각의 비율에 대한 것이 아니라, 두개의 비율 사이의 관계에 관한 문제이다. <br>
$\ $이 문제에 대해 현재 챕터에서 다루는 이유는, 첫째로, 이 주제는 비율에 관한 추론을 다루는 것이며 이전 챕터들에서 다룬 single proportions에 대한 추론의 연장선이다. 두번째로, 다음 챕터들에서 다룰 hierarchical 모델들에 대한 이해를 돕기 위해서이다. <br>
$\ $이 챕터에서 우리는 깁스 샘플링에 대한 개념을 배울 것이다. 이전 챕터에서 깁스 샘플링이 BUGS에 포함된 개념이라는 것만 배웠다. 깁스 샘플링에서는, 일반적인 Metropolis 알고리즘과는 달리, 제안된 jump 움직임이 한 번에 오직 한개의 파라미터에만 영향을 끼치며 이 제안은 절대로 거부당하지 않는다. 깁스 샘플링 방법론이 항상 작동하는 것은 아니지만, 작동하는 경우에는 굉장히 효율적인 알고리즘에 대해 알게 될 것이다.<br>
$\ $실제 예를 들어보면, 우리가 어떤 병으로 고통받는 100명의 인구 샘플을 갖고 있다고 해보자. 우리는 그들 중 절반에게 특정 약을 투여했고, 절반에게는 플라시보 효과를 주었다. 1주일 후에 약을 투여받은 사람들 중 12명은 개선 효과가 나타났고 플라시보 그룹에서는 5명이 약효를 보았다. 이 약은 실제로 플라시보 효과보다 효과가 있다고 말할 수 있을까? 그렇다면 얼마나 효과가 있는 것일까? 다르게 얘기하면, 관측되는 비율들의 차이에 기반해보면 (12/50 vs 5/50), 기저에 놓인 어떠한 차이가 실제로 신뢰할만 한 것일까? 이러한 문제들에 조금더 일반적으로 수학적 정교함을 갖추고 이야기를 풀기 위해선, 우리는 몇몇 표기들을 정의할 필요가 있다. 이전 챕터에서 사용했던 몇몇 같은 종류들의 표기를 사용하자. 그룹을 표기할 필요가 있다. 그룹 $"j"$ (j = 1 or j = 2)에서 "heads"의 비율을 $$\theta_j$$로 표기한다. 샘플 $$N_j$$에서 관측되는 실제 heads의 숫자 "flips"를 $$z_j$$로 표기하자. 마지막으로, 그룹 $j$에서 각각의 $i^{th}$ flip은 $$y_{ji}$$로 표기하자. 이번 챕터 전체에서 우리는 두개의 그룹이 서로 독립적이라고 가정할 것이다. 한 그룹의 퍼포먼스가 다른 그룹의 퍼포먼스에 영향을 끼치지 않는다. 일반적으로 우리가 가정한 이 독립성 가정이 들어맞는지에 대하여 우리는 실험을 디자인 한다. 우리가 앞으로 실행할 수학적 분석들에서 독립성은 매우 중요한다. 만약에 우리가 두개의 비율들이 서로 독립적이지 않은 상황에 처한다면, 이번 챕터에서의 방법론은 직접적으로 적용이 힘들 것이다. 데이터간의 의존성이 있는 상황에 대한 이야기는 이번 챕터에서 다루지 않는다.

## 8.1 Prior, likelihood and posterior for two proportions
$\ $ 기저에 놓인 두개의 비율 값들이 있다고 가정해보자($$\theta_1$$,$$\theta_2$$). 우리가 두 그룹에서 몇몇 데이터를 관측한 이후에, 이 값들에 대한 믿음을 결정지으려 한다. 베이지안 통계학에서는, 우리는 해당 데이터가 없을 때에 각각의 비율들에 대한 우리의 사전 믿음을 특정지어야 한다. 이 상황에서, 사전 믿음에 해당하는 확률 $$p(\theta_1, \theta_2)$$는 변수 $$\theta_1$$과 $$\theta_2$$에 의한 함수이다. 우리가 이 함수에 대한 그래프를 그려본다면, 두개 변수에 의한 함수이므로 3차원 형태의 함수가 된다. 또한 해당 함수는 확률밀도함수이므로, 다음이 성립한다. $$\int\int d\theta_1 d\theta_2 p(\theta_1, \theta_2) = 1$$. <br>
$\ $이 챕터의 몇몇 적용 사례에서는, 우리의 $\theta_1$에 대한 사전믿음과, $\theta_2$에 대한 사전믿음이 서로 독립이라고 가정할 것이다. 이런 독립의 경우에 문제는 꽤나 간단해질 수 있다. 그러나 꼭 이 두개의 변수들이 서로 독립이어야만 하는 것은 아니다. 독립이라는 개념 자체에 대해 혼동해서 안되는 것은, 독립이라는 개념이 두 변수 사이의 완벽한 인과관계를 보장하는 것은 아니라는 것이다. 단지, 독립인 두 변수 중 한 변수를 알게 되면, 다른 한 변수에 대한 믿음의 범위를 조금 더 좁힐 수 있다.<br>
$\ $동전 던지기 예시에서, 두 변수간의 독립은 다음과 같이 표현할 수 있다. $$p(y_1|\theta_1,\theta_2) = p(y_2|\theta_1)$$<br>
$ \$한 그룹에서 우리는 데이터 $D_1$를 얻었으며, 총 $$N_1$$의 시도 중에 $$z_1$$번 head를 얻었다. 또 다른 그룹에서 우리는 데이터 $D_2$를 얻었으며, 총 $$N_2$$의 시도 중에 $$z_2$$번 head를 얻었다. 이는 다음과 같이 표현할 수 있다 $$z_1 = \sum_{i=1}^{N_1} y_{1i}$$. 또한, $$z_1 \in \left\{0, ..., N_1\right\}$$ 이며, $$z_2 \in \left\{0, ..., N_2\right\}$$ 이다. 위와 같은 상황을 간단하게 다음과 같이 표현하자. $$D = \left\{z_1, N_1, z_2, N_2\right\}$$. 동전을 던지는 사건들의 독립성을 고려하면 $D$의 확률 값은 각각의 던지는 사건에 대한 베르누이 분포 함수의 곱들로 표현할 수 있다.<br>
!['Img1'](https://imgur.com/OYtItgw.png)
> $$D = \left\{2,5,3,7\right\}$$인 경우에 어떻게 표현하며 계산할지 직접 써보자.

기저에 놓인 비율들의 믿음에 대한 사후 분포는 일반적인 베이즈 규칙을 활용하여 아래와 같이 표현할 수 있다.
!['Img2'](https://imgur.com/J8TaJ47.png)
위의 수식에서, 좌항에 있는 $\theta$ 값들은 특정한 값을 지칭하는 것이지만, 우항의 분모에 있는 적분 내에 있는 $\theta_i$$들은 가능한 모든 $$\theta_i$$ 값에 걸친 것을 지칭하는 것임을 혼동하면 안된다.<br>
$\ $지금까지 살펴본 베이지안 규칙에 의한 두비율에 대한 추론은, 우도 함수가 독립적인 베르누이 분포일 때를 살펴봤다. 특정한 사전 분포에 대해 구체적으로 살펴보자. 형식적인 분석과 grid 근사법을 살펴본 후에 MCMC 근사로 넘어가보자. 특히, 우리는 첫째로 Gibbs 샘플링을 살펴볼 것이다. 마지막 섹션에서 우리는 두 비율간의 차이를 평가하는 데에 집중한다.
# 8.2 The posterior via exact formal analysis
