---
title: " [베이지안 통계학]사전확률? 사후확률? "
tags: Statistics
---

## Prior(사전확률)과 Posterior(사후확률)
베이즈 규칙에서 Prior(사전확률)과 Posterior(사후확률)에 대한 이해를 돕기 위해 간단한 동전의 경우를 살펴보자. 흠집이 없이 아주 대칭의 모양을 지닌('fair한') 동전은 그 동전을 던졌을 때, 50%의 확률로 앞면이, 50%의 확률로 뒷면이 나오게 될 것이다. 하지만 실제 경우에서 동전의 변형 또는 다른 다양한 이유로, 우리는 이 50%, 50% 확률이 때때로 왜곡된다고 생각할 수도 있다.
예를 들어, 동전 모양이 꽤나 왜곡돼서, 우리는 현재 이 동전을 던지면 20%의 확률로 앞면이, 80%의 확률로 뒷면이 나올 것이라고 믿고 있다. 이렇게 우리가 실제로 동전을 던져보기전에 갖고 있는 사건(event)에 대한 믿음을 사전확률이라고 하자.<br>
만약, 실제로 동전을 10번 던진 후 관찰 결과, 앞면이 2번, 뒷면이 8번 나왔다면, 우리는 우리가 이 사건 전에 지니고 있던 확률, 즉, Prior(사전확률)에 대한 믿음을 더욱 확고히 하게 된다.<br>
우리가 학교나 책을 통해 이 Prior와 Posterior에 대한 개념을 처음 접할 때, 보통 시간 순서로 (이전에 일어난 확률) 과 (이후에 일어난 확률)로 받아들인다. 하지만 이렇게 이해하는 것보다는, 특정한 데이터 셋(우리가 앞에서 본 동전을 던져 실제로 나온 비율의 값들)을 배제했을 때 우리의 믿음을 Prior, 포함시켰을 때 우리의 믿음을 Posterior로 이해하는 것이 낫다.<br>
데이터를 활용한 추론의 목표에는 크게 세 가지 종류가 있다.
<center><br>
- Estimation of parameter values<br>
- Prediction of data values<br>
- Model comparison<br>
</center>

## Bayes' Rule accounting for Data
- $$p(\theta|D) = posterior$$ 사후확률<br>
- $$p(D|\theta) = likelihood$$ 가능도<br>
- $$p(\theta) = prior$$ 사전확률<br>
- $$p(D) = evidence$$ 관측확률<br>
사전확률 = 데이터가 주어지지 않았을 때, theta 값의 분포 함수<br>
where the evidence is $$p(D) = \int d\theta p(D|\theta)p(\theta) $$<br>
Bayes' Rule : $$p(\theta|D) = p(D|\theta)p(\theta)/p(D)$$

## An example with coin flipping
동전을 던지는 예시에서 사전확률과 가능도, 사후확률의 분포에 대하여 아래 그래프를 보며 이해해보자. 우리는 현재 이 동전이 fair하다고 생각하므로, 우리의 사전 확률 분포는 아래의 맨 위 그래프 분포와 같다. 해당 사전분포를 가진 상태에서, 앞면이 3회, 뒷면이 9회 나올 확률을 계산해보면 해당 식은 $$p(D|\theta) = {\theta}^3(1-\theta)^9$$ 의 형태를 띄게 된다. 따라서 사전 확률 분포에서 $\theta$ 값이 0.25일 때 가능도는 가장 높고, 0.5일 때가 그 뒤를 따르며, 0.75일 때 가능도는 사실상 0에 가깝게 된다. 이렇게 가능도를 최대화시키는 $\theta$ 값을 maximal likelihood estimate of  $$\theta$$라고 부르자.<br>
이후에, evidence에 해당하는 $p(D)$에 대한 값을 계산해보자. 해당 값은 $$p(D) = \sum p(D|\theta)p(\theta)$$ 를 통해 계산한다. 이 계산된 값은 사후확률 분포의 normalizer로 사용될 것이므로, 해당 plot에 표기해준다.

!['Imgur'](https://imgur.com/Kmd35Rn.png)

위의 figure에서 사전확률, 우도를 활용해 사후확률이 업데이트 된 것을 좀 더 살펴보자. 사후확률 분포는 사전확률과 우도의 곱에 비례한다. 하지만 우도 함수에서 $\theta = 0.5 $ 에서의 값이 너무 작아, 사후분포에서 해당 값이 매우 움츠려든 것을 볼 수 있다. 우리가 기존에 믿던 사전확률 (동전이 매우 평평할 것이라는) 은 현재의 사후확률(이 동전이 평평할리 없다...)로 업데이트 됐다. 이렇게 베이지안 확률 계산은 정확하게 우리의 믿음이 어떻게 변하는 지에 대해 계산할 수 있게 해준다.

## Estimation of parameter values
파라미터 값들에 대한 추정은, 우리가 각각의 가능한 파라미터 값들에 대하여 어느 정도 까지 믿고 있는 가에 대한 정도를 결정하는 것을 지칭한다. 파라미터 값 $\theta$에 대한 사후 분포가 해당 값들에 대한 우리의 추정이라고 볼 수 있다.사후분포가 특정 $\theta$에 매우 좁게 분포 된 경우 우리는 꽤나 해당 $\theta$에 대하여 확신 할 수 있는 반면, 만약 사후 분포가 매우 넓게 큰 범위에 걸쳐있다면, 우리는 $\theta$에 대한 높은 불확실성을 갖게 된다.

## Prediction of data values
우리의 현재 믿음을 사용하여, 우리는 미래 값들의 확률을 예측하길 원한다. 추후에 나타날 수도 있는 표기적 혼란을 피하기 위해 이 데이터 값을 $y$로 설정하자. 예측되는 데이터 값 $y$는 가능한 모든 파라미터 값($\theta$)들에 대하여 단순 평균을 냄으로써 진행된다. :<br>
<center> $$p(y) = \int d\theta p(y|\theta)p(\theta) $$ </center><br>
이 값은 잘 들여다보면 정확하게 evidence에 해당한다.<br>
예를 들어서, 위의 Figure 최상단 그래프의 사전확률을 봐보자. 해당 믿음들에 관해 동전을 던질 때 H(head)를 얻게 될 확률 예측은 다음과 같다.

!['Imgur'](https://imgur.com/utLTyYj.png)
<br>
현재 모델의 믿음이 주어졌을 때, 각각의 가능한 데이터 수치의 확률들이 예측 값임에 주목해야한다.
## Model Comparison
